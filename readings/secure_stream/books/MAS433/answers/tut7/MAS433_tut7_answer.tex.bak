\documentclass[11pt]{article}
\usepackage{amsfonts}
\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{exscale}
\usepackage{graphicx}

\setlength{\parindent}{0pt}
\setlength\topmargin{0in}
\setlength\headheight{0in}
\setlength\headsep{0.3in}
\setlength\textheight{8.5in}
\setlength\textwidth{6.3in}
\setlength\oddsidemargin{0in}
\setlength\evensidemargin{0in}
\setlength{\tabcolsep}{3pt}
\setlength\parskip{1ex plus 0.5ex minus 0.2ex}
\def\mod{\operatorname{mod}}




\title{MAS 433 Tutorial 7}
\author{Wang Xueou (087199E16)}
\begin{document}
\maketitle


\textbf{Question 1 } Solution: \\
Let $m^\prime = m + k\cdot n$, then
$$
(m^\prime)^d \mod n = (m + k\cdot n)^d \mod n= (m^d + \sum_{i=1}^{d-1}{m^{d-i}(k\cdot n)^i} + (k\cdot n)^d) \mod n = m^d \mod n =s
$$
Thus, without hashing, $m$ can be modified to be $m^\prime = m + k\cdot n, \forall k \in Z$ \\

\textbf{Question 2 } Solution: \\
\textbf{2.1 } \\
If $s=0$, then
$$
(H(M)-xr)K^{-1} \mod p-1 = 0
$$
Since $K^{-1}$ is not zero, $H(M)-xr \mod p-1 = 0, \Rightarrow H(M)\equiv xr (\mod p-1)$. If $r, H(M)$ is known, we can compute $x$. If $x$ is coprime to $p-1$, we have a unique solution; otherwise, we try several solutions.\\

\textbf{2.2 } \\
Let $r=g^k \mod p$, then
$$
\begin{array}{c}
s_1=(H(m_1)-xr)k^{-1} \mod p-1 \\
s_2=(H(m_2)-xr)k^{-1} \mod p-1
\end{array}
$$
In this linear system, we have 2 unknowns: $x, k$ and 2 equations. So this system can be solved and we can get
$$
s_2H(m_1)-s_1H(m_2)=xr(s_2-s_1) \mod p-1
$$

\textbf{2.3 } \\
We have
$$
\begin{array}{ccc}
r_{i} &=& g^{k_i}\mod p\\
r_{i+1} &=& g^{k_{i+1}}\mod p
\end{array}
$$
Then
$$
\begin{array}{ccl}
k_{i+1} &=& k_i + a \\
s_i &=& ((H(m_i)+xr_i)k_i^{-1}) \mod p-1 \\
s_{i+1} &=& ((H(m_{i+1})+xr_{i+1})k_{i+1}^{-1}) \mod p-1
\end{array}
$$
We now have 3 unknowns, $k_i, k_{i+1}, x$ and 3 equations, so we can solve the system and get $x$.\\

\textbf{2.4 } \\
We have
$$
\begin{array}{ccc}
r_{i} &=& g^{k_i}\mod p \\
r_{i+1} &=& g^{k_{i+1}}\mod p  \\
r_{i+2} &=& g^{k_{i+2}}\mod p
\end{array}
$$
Then
$$
\begin{array}{ccl}
s_i &=& ((H(m_i)+xr_i)k_i^{-1}) \mod p-1 \\
s_{i+1} &=& ((H(m_{i+1})+xr_{i+1})k_{i+1}^{-1}) \mod p-1 \\
s_{i+2} &=& ((H(m_{i+2})+xr_{i+2})k_{i+2}^{-1}) \mod p-1 \\
k_{i+1} &=& k_i + a \\
k_{i+2} &=& k_i + 2a
\end{array}
$$
We now have 5 unknowns, $k_i, k_{i+1}, k_{i+2}, a, x$ and 5 equations, so we can solve the system and get $x$.\\

\textbf{Question 3 } Solution:\\
\textbf{3.1 } \\
If the secret integer $k$ is reused, then
$$
r=(g^k \mod p) \mod q
$$
Then we have
$$
\begin{array}{c}
s_1=(k^{-1}(H(m_1)+xr))\mod q \\
s_2=(k^{-1}(H(m_2)+xr))\mod q
\end{array}
$$
We have 2 unknowns, $k,x$ and 2 equations, so we can solve the linear system to get $x$. \\

\textbf{3.2 } \\
If $s=k^{-1}(H(m)-xr)\mod q$, then the signature verification can be modified as:
$$
\begin{array}{lcl}
\textnormal{Calculate } u1 &=& H(m)s^{-1} \mod q \\
\textnormal{Calculate } u2 &=& rs^{-1} \mod q \\
\textnormal{Calculate } v &=& ((g^{u1}y^{-u2})\mod p ) \mod q
\end{array}
$$
Then we check $v \stackrel{?}{=} r$ \\

\textbf{3.3 } \\
Let $t = aq + b$, i.e., $b = t \mod q$, and let $p - 1 = k \cdot q$, then
$$
g^t \mod p = h^{\frac{p-1}{q}\cdot t} \mod p = h^{k\cdot t} \mod p = h^{k\cdot(aq + b)} \mod p = h^{a(k\cdot q) + kb} \mod p = h^{p-1}h^{kb} \mod p = h^{kb} \mod p = g^b \mod p
$$
$$
g^{t\mod q}\mod p = g^b\mod p
$$
Thus, $g^t \mod p = g^{t\mod q}\mod p$ \\

\textbf{Question 4 } Solution: \\
\textbf{4.1 } \\
If the attacker does not have the capability to modify the internet traffic, it is secure. If the attacker can modify the internet traffic, he or she can launch the man-in-the-middle attack to modify the public key. \\

\textbf{4.2 } \\
If the public key certificate is invalid, the keys are no longer secure anymore. The attacker may launch the man-in-the-middle attack to decrypt the communication between users. \\

\textbf{Question 5 } Solution: \\
There is no unconditionally secure public key cryptosystem. In public key cryptosystem, everyone knows the public key. So if the computing power is unlimited, we can always recover the private key.

\textbf{Question 6 } Solution: \\
\textbf{6.1.}\\
Let $C=(c_1,c_2)$, then after receiving $C$:
\begin{itemize}{-}

\end{itemize}

\end{document} 